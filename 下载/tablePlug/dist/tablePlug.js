/** layui-v2.4.5 MIT License By https://www.layui.com */
 ;layui.define(["table"],function(e){"use strict";var a=layui.$,t=(layui.laytpl,layui.laypage,layui.layer,layui.form),i=(layui.util,layui.table),n=layui.hint(),l=(layui.device(),{}),r="additional",o="removed",c="original",u="layui-none",s="layui-hide",d="layui-tablePlug-loading-p",f=".layui-table-header",h="colGroup",y=function(){return!!i.thisTable}(),g=function(e){return y?i.thisTable.that[e]:(n.error("getIns方法需要在对layui的table进行一定必要的改造才能使用！请到 https://fly.layui.com/jie/43423/ 里面的查看相关内容将table.js进行一个非常小的改造，之后再试试看。"),{})},p=function(){var e={};return{check:function(a){return!!e[a]},reset:function(a){e[a]?(this.set(a,r,[]),this.set(a,o,[])):e[a]={original:[],additional:[],removed:[]}},init:function(e,a){this.reset(e),this.set(e,c,a)},getChecked:function(e){var a=this.get(e,o),t=this.get(e,c).concat(this.get(e,r)),i=[];return layui.each(t,function(e,t){a.indexOf(t)===-1&&i.indexOf(t)===-1&&i.push(t)}),i},get:function(a,t){return t===r||t===o||t===c?e[a]?e[a][t]:[]:e[a]},set:function(a,t,i){t!==c&&t!==r&&t!==o||(e[a][t]=i&&v(i)?i:[])},update:function(a,t,i){var n=e[a][c],l=e[a][r],u=e[a][o];i?n.indexOf(t)===-1?l.indexOf(t)===-1&&l.push(t):u.indexOf(t)!==-1&&u.splice(u.indexOf(t),1):n.indexOf(t)===-1?l.indexOf(t)!==-1&&l.splice(l.indexOf(t),1):u.indexOf(t)===-1&&u.push(t)}}}(),v=function(e){return"[object Array]"===Object.prototype.toString.call(e)},m=function(e,a,t){if(e&&a)for(var n=p.get(a,r)||[],l=p.get(a,c)||[],u=p.get(a,o)||[],s=n.concat(l.filter(function(e,a){return u.indexOf(e)===-1})),d=0;d<e.length;d++)s.indexOf(e[d].id)!==-1&&(e[d][t||i.config.checkName]=!0)},x=i.render;i.render=function(e){var t=this,n=a.extend(!0,{},i.config,e),r=n.id||a(n.elem).attr("id");n.checkStatus&&!p.check(r)&&p.init(r,n.checkStatus["default"]);var o=n.parseData;if(o&&o.plugFlag||(e.parseData=function(e){e="function"==typeof o?o.call(t,e)||e:e;var a=n.response?n.response.dataName||"data":"data";return m(e[a],r),e},e.parseData.plugFlag=!0),n.colFilterRecord){var c=T.get(r,e.colFilterRecord);a.each(e.cols,function(e,t){a.each(t,function(e,a){a.hide=!!c[a.field]})})}else T.clear(r);e.cols.length>1&&layui.each(e.cols,function(e,a){layui.each(a,function(e,a){a.field||a.toolbar||a.colspan&&1!==a.colspan?!a[h]||a.colspan>1||(a[h]=!1):a[h]=!0})});var y=x.call(t,e),v=y.config.elem.next();v.attr("lay-id")!==y.config.id&&v.attr("lay-id",y.config.id);var b=g(y.config.id);if(b&&b.index){var k=b.setColsWidth;k.call(b);var O=b.loading;b.loading=function(e){var t=this;if(O.call(t,e),!e&&t.layInit){t.layInit.remove(),t.layInit.addClass("layui-anim layui-anim-rotate layui-anim-loop"),t.layMain.height()||t.layBox.append(a('<div class="'+d+'" style="height: 56px;"></div>'));var i=0;t.layMain.height()-t.layMain.prop("clientHeight")>0&&(i=t.getScrollWidth()),t.layInit.height(t.layBox.height()-t.layHeader.height()-i).css("marginTop",t.layHeader.height()+"px"),t.layBox.append(t.layInit)}},b.setColsWidth=function(){var e=this;e.layBox.find("."+d).remove(),k.call(e);var t=e.config;if(t.cols.length>1){var i=e.layFixed.find(f).find("th"),n=e.layHeader.height();n/=t.cols.length,i.each(function(e,t){t=a(t),t.height(n*parseInt(t.attr("rowspan")||1)-1-parseFloat(i.css("padding-top"))-parseFloat(i.css("padding-bottom")))})}if(e.elem.data("patch")===!0){e.elem.data("patch",null);var l=v.find("."+u);if(l.length){e.layFixed.find("tbody").html(""),e.layFixed.addClass(s);var r=['<table cellspacing="0" cellpadding="0" border="0" class="layui-table"><tbody></tbody></table>'],o=l.prev();o&&o.length||a(r.join("")).insertBefore(l),e.layTotal.addClass(s),e.layPage.addClass(s),e.layBox.find('input[lay-filter="layTableAllChoose"]').prop("checked",!1)}else{var c=e.layFixed.prevObject;c.find(e.layFixed.selector).length||e.layBox.append(e.layFixed),e.layFixLeft.removeClass(s),e.layTotal.removeClass(s)}e.renderForm("checkbox")}},b.config.url?b.loading():b.setColsWidth()}return l[y.config.id]=y};var b=i.reload,k=function(){var e=["url","method","where","contentType","headers","parseData","request","response","data","page","initSort","autoSort"];return{getParams:function(){return e},registParams:function(){var a=this;layui.each(arguments,function(t,i){v(i)?a.registParams.apply(a,i):"string"==typeof i&&e.indexOf(i)===-1&&e.push(i)})},check:function(){}}}(),O=function(){var e=!1;return{enable:function(){if(!arguments.length)return e;var a=arguments[0];"boolean"!=typeof a?n.error("如果要开启或者关闭全局的表格智能重载模式，请传入一个true/false为参数"):e=a}}}();k.registParams("colFilterRecord","checkStatus","smartReloadModel"),i.reload=function(e,t){var r=this,o=C(e),c=a.extend(!0,{},C(e),t);if(O.enable()&&c.smartReloadModel){var u=!1;if(!!c.page!=!!o.page&&(u=!0),!u){var s=a.extend(!0,[],k.getParams());layui.each(t,function(e,a){var t=s.indexOf(e);return t===-1?u=!0:void s.splice(t,1)})}if(!u){if(y){var d=g(e);return"object"==typeof t.page&&(t.page.curr&&(d.page=t.page.curr),delete t.elem,delete t.jump),a.extend(!0,d.config,t),d.config.page||(d.page=1),d.elem.data("patch",!0),d.loading(),d.pullData(d.page),i.thisTable.call(d)}n.error("您开启了智能重载模式，但是未检测到一个必要的前提，另参考帖子 https://fly.layui.com/jie/43423/ 里面的相关内容将table.js进行一个非常小的改造，之后再试试看。")}}var d=b.call(r,e,t);return l[d.config.id]=d};var C=function(e){return l[e]&&l[e].config},F=i.checkStatus;i.checkStatus=function(e){var a=this,t=C(e),i=F.call(a,e);return t&&t.checkStatus&&(i.status=p.get(e)),i},i.on("checkbox",function(e){var t=a(this).closest(".layui-table-view"),i=t.attr("lay-id"),n=C(i);if(n.page&&n.checkStatus&&p.check(i)){var l=e.checked,r=e.data,o=e.type,c=n.checkStatus.primaryKey||"id";"one"===o?p.update(i,r[c],l):"all"===o&&layui.each(layui.table.cache[i],function(e,a){p.update(i,a[c],l)})}}),t.on("checkbox",function(e){a(e.elem).change()});var T=function(){var e="tablePlug_col_filter_record",t=function(e){return"local"===e?"data":"sessionData"};return{set:function(a,i,n,l){if(a&&i){var r=t(l),o=this.get(a,l);o[i]=!n,layui[r](e,{key:a,value:o})}},get:function(a,i){return layui[t(i)](e)[a]||{}},clear:function(t){a.each(["data","sessionData"],function(a,i){layui[i](e,{key:t,remove:!0})})}}}();a(document).on("change",'input[lay-filter="LAY_TABLE_TOOL_COLS"]',function(e){var t=a(this),i=t.attr("name"),n=t.closest(".layui-table-view"),l=n.attr("lay-id"),r=C(l),o=r.colFilterRecord;o?T.set(l,i,this.checked,o):T.clear(l)});var P={CHECK_TYPE_ADDITIONAL:r,CHECK_TYPE_REMOVED:o,CHECK_TYPE_ORIGINAL:c,tableCheck:p,getConfig:C,colFilterRecord:T,getIns:g,queryParams:k,smartReload:O};e("tablePlug",P)});